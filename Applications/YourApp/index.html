<!DOCTYPE html>
<html>

<head>
    <title>swoole chat room</title>
    <meta charset="UTF-8">
    <script type="text/javascript">
        if (window.WebSocket) {
            var webSocket = new WebSocket("ws://127.0.0.1:8282");
            webSocket.onopen = function(event) {
                //webSocket.send("Hello,WebSocket!");
            };
            webSocket.onmessage = function(event) {
                var content = document.getElementById('content');
                content.innerHTML = content.innerHTML.concat('<p style="margin-left:20px;line-height:20px;">' + event.data + '</p>');
                content.scrollTop = content.scrollHeight;
            }

            var sendMessage = function() {
                var data = document.getElementById('message').value;
                if (Trim(data) != "") {
                    webSocket.send(data);
                }
                document.getElementById('message').value = "";
            }

            function keySend(event) {
                if (event.keyCode == 13) {
                    sendMessage();
                }
            }

            function Trim(str) {
                return str.replace(/(^\s*)|(\s*$)/g, "");
            }
        } else {
            console.log("您的浏览器不支持WebSocket");
        }
    </script>
</head>

<body>
    <div style="width:600px;margin:0 auto;border:1px solid #ccc;">
        <div id="content" style="overflow-y:auto;word-break:break-all;height:300px;"></div>
        <hr/>
        <div style="height:40px">
            <input type="text" id="message" onkeydown="keySend(event)" style="margin-left:10px;height:25px;width:450px;">
            <button onclick="sendMessage()" style="height:28px;width:75px;">发送</button>
        </div>
    </div>
</body>

</html>